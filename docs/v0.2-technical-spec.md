# Lily Cafe POS - Version 0.2 Technical Specification

**Project Name:** Lily Cafe Point of Sale System  
**Version:** 0.2 - "The Inventory Tracker & Cash Counter"  
**Client:** Lily Cafe by Mary's Kitchen  
**Status:** Planning Complete - Ready for Development  
**Created:** November 11, 2025  
**Prerequisites:** v0.1 Complete & Deployed

---

## ğŸ“‹ Table of Contents

1. [Version Overview](#version-overview)
2. [User Roles & Access](#user-roles--access)
3. [Core Features](#core-features)
4. [Database Schema](#database-schema)
5. [API Endpoints](#api-endpoints)
6. [User Flows](#user-flows)
7. [Component Specifications](#component-specifications)
8. [UI/UX Design](#uiux-design)
9. [Business Logic](#business-logic)
10. [Testing Checklist](#testing-checklist)
11. [Definition of Done](#definition-of-done)

---

## ğŸ¯ Version Overview

### What's New in v0.2

**Primary Goals:**
1. **Add dark mode** - Modern UI enhancement (warm-up feature)
2. Enable manual inventory tracking for ingredients and supplies
3. Implement daily cash counter with owner verification
4. Provide visibility into stock levels and cash flow
5. Prevent stockouts through low-stock alerts

**Philosophy:**
- **Start small, build momentum** - Dark mode first as a confidence builder
- **Manual tracking reflects reality** - Kitchen staff record actual usage, not theoretical calculations
- **Future-ready architecture** - Built to accommodate automatic suggestions later
- **Simple daily workflows** - Minimal friction for staff operations

**Development Order:**
1. **Dark Mode** (1-2 days) - Isolated feature, immediate visual feedback, good warm-up
2. **Inventory Management** (5-7 days) - Core functionality with database work
3. **Cash Counter** (2-3 days) - Business logic and calculations
4. **Polish & Testing** (2-3 days) - Integration and edge cases

**Timeline:**
- **Approach:** Quality over arbitrary deadlines ("done when it's done")
- **Estimated:** 1.5-2 weeks of focused development
- **Flexibility:** Learning Python/FastAPI while building

---

### Success Criteria

Version 0.2 is **complete and ready for deployment** when:

1. âœ… Admin can add/edit/delete inventory items and categories
2. âœ… Admin can record purchases (stock additions)
3. âœ… Kitchen staff can record daily usage on mobile (stock reductions)
4. âœ… Admin can make physical count adjustments
5. âœ… Low stock alerts appear on admin dashboard
6. âœ… Transaction history shows complete audit trail
7. âœ… Admin can open/close daily cash counter
8. âœ… Owner can verify cash counter with password
9. âœ… Cash variance calculations are accurate
10. âœ… All features work reliably on cafe's WiFi network

---

## ğŸ‘¥ User Roles & Access

### 1. Waiter/Kitchen Staff (No Login Required)
**Device:** Mobile phone  
**New Access:**
- Record daily inventory usage (mobile-optimized form)

**Existing Access (from v0.1):**
- View table status
- Take orders
- View active orders

---

### 2. Admin/Owner (Login Required)
**Device:** Desktop computer at reception (+ mobile responsive)  
**New Access:**
- Full inventory management (items, categories)
- Record purchases and adjustments
- View inventory dashboard with alerts
- View transaction history
- Open/close daily cash counter
- Verify cash counter (with owner password prompt)
- View cash counter history

**Existing Access (from v0.1):**
- All waiter functions
- Generate bills and payments
- Menu management
- Order history

---

## ğŸ†• Core Features

### Feature 0: Dark Mode Theme Toggle

**Purpose:** Provide a dark color scheme option for better viewing in low-light environments

**Capabilities:**
- Toggle between light and dark themes
- Persistent theme preference (saved in localStorage)
- Smooth transition animations between themes
- System preference detection (respects OS dark mode setting)
- Theme toggle accessible from all pages

**Implementation Approach:**
- CSS variables for all colors
- React Context for theme state
- localStorage for persistence
- Tailwind's dark mode utilities

**User Benefits:**
- Reduced eye strain in low-light environments
- Battery savings on OLED screens (mobile)
- Modern UX expectation
- Professional appearance

**Business Rules:**
- Default: Light mode (or system preference if first visit)
- Preference persists across sessions
- All pages respect theme choice
- Smooth 200ms transition between modes

**Technical Decisions:**
- **Why now?** Good warm-up feature before complex inventory work
- **Storage:** localStorage (simple, no backend needed)
- **Scope:** Full app (all existing v0.1 pages + new v0.2 pages)
- **Design:** Coffee theme colors adapted for dark mode

---

### Feature 1: Inventory Categories Management

**Purpose:** Organize inventory items into logical groups

**Capabilities:**
- Create new categories (e.g., "Dairy", "Grains", "Vegetables")
- Edit category names
- Delete unused categories (soft delete)
- View all categories

**Business Rules:**
- Category names must be unique
- Cannot delete category if inventory items reference it
- Case-insensitive validation

---

### Feature 2: Inventory Items Management

**Purpose:** Track all ingredients and supplies

**Capabilities:**
- Add new inventory items with details:
  - Name (e.g., "Milk", "Flour", "Eggs")
  - Unit of measurement (L, kg, pcs, g, ml)
  - Current quantity
  - Minimum threshold (for alerts)
  - Cost per unit (optional, for future analytics)
  - Category
- Edit existing items
- Soft delete items (set inactive)
- View current stock levels
- Search and filter items

**Business Rules:**
- Item names must be unique within a category
- Quantities use Decimal type (no float errors)
- Negative quantities not allowed
- Threshold must be >= 0

---

### Feature 3: Purchase Tracking (Stock Additions)

**Purpose:** Record when supplies are purchased/received

**Workflow:**
1. Admin receives delivery from supplier
2. Opens "Add Stock" interface
3. Selects items and enters quantities received
4. Optionally adds notes (e.g., "Supplier: ABC Foods")
5. System creates PURCHASE transaction
6. Current quantity increases

**Business Rules:**
- Purchase quantities must be positive
- Transaction recorded with timestamp and user
- Previous and new quantities stored for audit
- Cannot purchase negative amounts

---

### Feature 4: Daily Usage Recording (Stock Reductions)

**Purpose:** Track actual ingredient consumption

**Workflow:**
1. End of shift: Kitchen staff opens mobile form
2. Sees list of inventory items (can search/filter)
3. Enters quantities used during shift
4. Adds optional notes
5. System creates USAGE transaction
6. Current quantity decreases

**Mobile Interface:**
- Quick input with number pad
- Common items at top
- Search functionality
- Bulk submit
- Works offline (submits when back online)

**Business Rules:**
- Usage quantities must be positive
- Cannot use more than current stock (warning but allowed)
- Transaction recorded with timestamp and user
- Zero quantities ignored (not recorded)

---

### Feature 5: Physical Count Adjustments

**Purpose:** Correct discrepancies between system and reality

**Workflow:**
1. Admin performs physical inventory count
2. Opens "Adjust Inventory" interface
3. Enters actual counted quantity
4. System calculates difference
5. Adds note explaining adjustment
6. System creates ADJUSTMENT transaction
7. Current quantity updated to match reality

**Business Rules:**
- Can adjust to any quantity (including zero)
- Requires mandatory note/reason
- Highlights large discrepancies (>20% variance)
- Transaction audit trail preserved

---

### Feature 6: Low Stock Alerts

**Purpose:** Prevent stockouts by alerting admin

**Mechanism:**
- Automatic: System checks current quantity vs threshold
- Visual indicator on admin dashboard
- Card showing low stock items
- Red/yellow indicators in inventory list

**Dashboard Alert Card:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ Low Stock Items (3)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¥› Milk - 2L left       â”‚
â”‚    Threshold: 5L        â”‚
â”‚ ğŸ Bread - 5 pcs left   â”‚
â”‚    Threshold: 10 pcs    â”‚
â”‚ ğŸ§€ Cheese - 200g left   â”‚
â”‚    Threshold: 500g      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Business Rules:**
- Alert when current_quantity < min_threshold
- No notifications in v0.2 (just visual)
- Admin-only visibility
- Sorted by urgency (% below threshold)

---

### Feature 7: Inventory Transaction History

**Purpose:** Complete audit trail for accountability

**View Options:**
- All transactions (paginated)
- Filter by item
- Filter by type (PURCHASE, USAGE, ADJUSTMENT)
- Filter by date range
- Filter by user who recorded

**Display:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Date/Time | Item | Type | Qty | By | Notes   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Nov 11, 10:30 AM | Milk | PURCHASE | +20L | â”‚
â”‚   admin | Supplier: ABC Foods               â”‚
â”‚   Previous: 5L â†’ New: 25L                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Nov 11, 11:00 PM | Milk | USAGE | -8L |     â”‚
â”‚   kitchen_staff | End of day count          â”‚
â”‚   Previous: 25L â†’ New: 17L                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Business Rules:**
- Immutable records (no editing/deleting)
- Sortable and searchable
- Export capability (CSV) - v0.3
- Timestamps in local timezone

---

### Feature 8: Daily Cash Counter

**Purpose:** Track and reconcile cash drawer daily

**Opening Counter (Morning):**
1. Admin logs in
2. Opens "Cash Counter" from dashboard
3. Counts physical cash in drawer
4. Enters opening balance (e.g., â‚¹5,000)
5. Submits â†’ Counter status: "Open"

**During Day:**
- Orders are paid (v0.1 functionality)
- Cash payments automatically tracked
- No interaction with cash counter needed

**Closing Counter (Evening):**
1. Admin opens "Cash Counter"
2. Sees:
   - Opening balance
   - Total cash payments from orders
   - Expected closing balance (calculated)
3. Counts physical cash in drawer
4. Enters actual closing balance
5. System shows variance (expected vs actual)
6. Adds optional notes
7. Submits â†’ Counter status: "Closed - Pending Verification"

**Verification (Owner Only):**
1. Owner reviews closed counter
2. Clicks "Verify" button
3. Modal prompts for owner password
4. Enters password
5. If correct â†’ Counter marked "Verified âœ…"
6. If incorrect â†’ Error shown, try again

**Business Rules:**
- One counter per day (date is unique)
- Cannot close without opening
- Cannot open if already open
- Expected closing = opening + cash payments from orders
- Variance = actual - expected
- Only owner password can verify
- Cannot edit after verification

---

## ğŸ—„ï¸ Database Schema

### New Tables (4)

#### 1. inventory_categories

```python
class InventoryCategory(Base):
    __tablename__ = "inventory_categories"
    
    id: int (PK, autoincrement)
    name: str (unique, not null, max 100 chars)
    created_at: datetime (default: now)
    updated_at: datetime (default: now, onupdate: now)
    
    # Relationships
    items: relationship â†’ InventoryItem (back_populates="category")
```

**Indexes:**
- PRIMARY KEY: id
- UNIQUE: name

---

#### 2. inventory_items

```python
class InventoryItem(Base):
    __tablename__ = "inventory_items"
    
    id: int (PK, autoincrement)
    name: str (not null, max 200 chars)
    unit: str (not null, max 20 chars)  # "L", "kg", "pcs", "g", "ml"
    current_quantity: Decimal(10, 2) (not null, default: 0)
    min_threshold: Decimal(10, 2) (not null, default: 0)
    cost_per_unit: Decimal(10, 2) (nullable)  # Optional for v0.2
    category_id: int (FK â†’ inventory_categories.id, nullable)
    is_active: bool (not null, default: True)  # Soft delete
    created_at: datetime (default: now)
    updated_at: datetime (default: now, onupdate: now)
    
    # Relationships
    category: relationship â†’ InventoryCategory (back_populates="items")
    transactions: relationship â†’ InventoryTransaction (back_populates="item")
    
    # Computed property
    @property
    def is_low_stock(self) -> bool:
        return self.current_quantity < self.min_threshold
```

**Indexes:**
- PRIMARY KEY: id
- INDEX: category_id
- INDEX: is_active
- UNIQUE: (name, category_id) - unique within category

---

#### 3. inventory_transactions

```python
class TransactionType(str, Enum):
    PURCHASE = "PURCHASE"
    USAGE = "USAGE"
    ADJUSTMENT = "ADJUSTMENT"

class InventoryTransaction(Base):
    __tablename__ = "inventory_transactions"
    
    id: int (PK, autoincrement)
    item_id: int (FK â†’ inventory_items.id, not null)
    transaction_type: TransactionType (not null)
    quantity: Decimal(10, 2) (not null)  # Positive or negative
    notes: str (nullable, max 500 chars)
    recorded_by: str (not null, max 100 chars)  # Username/staff name
    previous_quantity: Decimal(10, 2) (not null)  # For audit
    new_quantity: Decimal(10, 2) (not null)  # For audit
    created_at: datetime (default: now, not null)
    
    # Relationships
    item: relationship â†’ InventoryItem (back_populates="transactions")
```

**Indexes:**
- PRIMARY KEY: id
- INDEX: item_id
- INDEX: transaction_type
- INDEX: created_at
- INDEX: recorded_by

**Business Logic:**
- Quantity positive for PURCHASE and ADJUSTMENT increases
- Quantity negative for USAGE and ADJUSTMENT decreases
- Previous and new quantity always stored for audit trail
- Immutable after creation (no updates/deletes)

---

#### 4. daily_cash_counter

```python
class DailyCashCounter(Base):
    __tablename__ = "daily_cash_counter"
    
    id: int (PK, autoincrement)
    date: Date (unique, not null)
    opening_balance: Decimal(10, 2) (not null)
    closing_balance: Decimal(10, 2) (nullable)  # NULL until closed
    expected_closing: Decimal(10, 2) (nullable)  # Calculated when closed
    variance: Decimal(10, 2) (nullable)  # actual - expected
    notes: str (nullable, max 500 chars)
    opened_by: str (not null, max 100 chars)
    closed_by: str (nullable, max 100 chars)
    verified_by: str (nullable)  # Always "owner" when verified
    opened_at: datetime (not null, default: now)
    closed_at: datetime (nullable)
    verified_at: datetime (nullable)
    is_verified: bool (not null, default: False)
```

**Indexes:**
- PRIMARY KEY: id
- UNIQUE: date
- INDEX: is_verified

**Computed Fields:**
```python
@property
def status(self) -> str:
    if self.is_verified:
        return "verified"
    elif self.closing_balance is not None:
        return "closed_pending_verification"
    else:
        return "open"
```

---

### Database Migrations

**Migration Script: v0.2_add_inventory_and_cash.py**

```python
"""
Add inventory management and cash counter tables

Revision ID: v0.2_001
Revises: v0.1_final
Create Date: 2025-11-11
"""

def upgrade():
    # 1. Create inventory_categories table
    op.create_table(
        'inventory_categories',
        sa.Column('id', sa.Integer(), nullable=False),
        sa.Column('name', sa.String(100), nullable=False),
        sa.Column('created_at', sa.DateTime(), server_default=sa.func.now()),
        sa.Column('updated_at', sa.DateTime(), onupdate=sa.func.now()),
        sa.PrimaryKeyConstraint('id'),
        sa.UniqueConstraint('name')
    )
    
    # 2. Create inventory_items table
    op.create_table(
        'inventory_items',
        sa.Column('id', sa.Integer(), nullable=False),
        sa.Column('name', sa.String(200), nullable=False),
        sa.Column('unit', sa.String(20), nullable=False),
        sa.Column('current_quantity', sa.Numeric(10, 2), nullable=False, default=0),
        sa.Column('min_threshold', sa.Numeric(10, 2), nullable=False, default=0),
        sa.Column('cost_per_unit', sa.Numeric(10, 2), nullable=True),
        sa.Column('category_id', sa.Integer(), nullable=True),
        sa.Column('is_active', sa.Boolean(), nullable=False, default=True),
        sa.Column('created_at', sa.DateTime(), server_default=sa.func.now()),
        sa.Column('updated_at', sa.DateTime(), onupdate=sa.func.now()),
        sa.PrimaryKeyConstraint('id'),
        sa.ForeignKeyConstraint(['category_id'], ['inventory_categories.id']),
        sa.UniqueConstraint('name', 'category_id', name='uq_name_category')
    )
    op.create_index('ix_inventory_items_category_id', 'inventory_items', ['category_id'])
    op.create_index('ix_inventory_items_is_active', 'inventory_items', ['is_active'])
    
    # 3. Create inventory_transactions table
    op.create_table(
        'inventory_transactions',
        sa.Column('id', sa.Integer(), nullable=False),
        sa.Column('item_id', sa.Integer(), nullable=False),
        sa.Column('transaction_type', sa.String(20), nullable=False),
        sa.Column('quantity', sa.Numeric(10, 2), nullable=False),
        sa.Column('notes', sa.String(500), nullable=True),
        sa.Column('recorded_by', sa.String(100), nullable=False),
        sa.Column('previous_quantity', sa.Numeric(10, 2), nullable=False),
        sa.Column('new_quantity', sa.Numeric(10, 2), nullable=False),
        sa.Column('created_at', sa.DateTime(), server_default=sa.func.now()),
        sa.PrimaryKeyConstraint('id'),
        sa.ForeignKeyConstraint(['item_id'], ['inventory_items.id'], ondelete='CASCADE')
    )
    op.create_index('ix_inventory_transactions_item_id', 'inventory_transactions', ['item_id'])
    op.create_index('ix_inventory_transactions_type', 'inventory_transactions', ['transaction_type'])
    op.create_index('ix_inventory_transactions_created_at', 'inventory_transactions', ['created_at'])
    
    # 4. Create daily_cash_counter table
    op.create_table(
        'daily_cash_counter',
        sa.Column('id', sa.Integer(), nullable=False),
        sa.Column('date', sa.Date(), nullable=False),
        sa.Column('opening_balance', sa.Numeric(10, 2), nullable=False),
        sa.Column('closing_balance', sa.Numeric(10, 2), nullable=True),
        sa.Column('expected_closing', sa.Numeric(10, 2), nullable=True),
        sa.Column('variance', sa.Numeric(10, 2), nullable=True),
        sa.Column('notes', sa.String(500), nullable=True),
        sa.Column('opened_by', sa.String(100), nullable=False),
        sa.Column('closed_by', sa.String(100), nullable=True),
        sa.Column('verified_by', sa.String(100), nullable=True),
        sa.Column('opened_at', sa.DateTime(), server_default=sa.func.now()),
        sa.Column('closed_at', sa.DateTime(), nullable=True),
        sa.Column('verified_at', sa.DateTime(), nullable=True),
        sa.Column('is_verified', sa.Boolean(), nullable=False, default=False),
        sa.PrimaryKeyConstraint('id'),
        sa.UniqueConstraint('date')
    )
    op.create_index('ix_daily_cash_counter_is_verified', 'daily_cash_counter', ['is_verified'])

def downgrade():
    op.drop_table('daily_cash_counter')
    op.drop_table('inventory_transactions')
    op.drop_table('inventory_items')
    op.drop_table('inventory_categories')
```

---

## ğŸ”Œ API Endpoints

### Inventory Categories (4 endpoints)

#### 1. Get All Categories
```
GET /api/v1/inventory/categories
Auth: Not required (used by waiters too)
```

**Response (200):**
```json
{
  "categories": [
    {
      "id": 1,
      "name": "Dairy",
      "created_at": "2025-11-11T09:00:00",
      "item_count": 5
    },
    {
      "id": 2,
      "name": "Grains",
      "created_at": "2025-11-11T09:00:00",
      "item_count": 3
    }
  ]
}
```

---

#### 2. Create Category
```
POST /api/v1/inventory/categories
Auth: Required (admin only)
```

**Request:**
```json
{
  "name": "Vegetables"
}
```

**Response (201):**
```json
{
  "id": 3,
  "name": "Vegetables",
  "created_at": "2025-11-11T10:00:00"
}
```

**Errors:**
- 400: Category name already exists
- 401: Unauthorized

---

#### 3. Update Category
```
PATCH /api/v1/inventory/categories/{category_id}
Auth: Required (admin only)
```

**Request:**
```json
{
  "name": "Fresh Vegetables"
}
```

**Response (200):**
```json
{
  "id": 3,
  "name": "Fresh Vegetables",
  "updated_at": "2025-11-11T10:30:00"
}
```

**Errors:**
- 400: Category name already exists
- 404: Category not found

---

#### 4. Delete Category
```
DELETE /api/v1/inventory/categories/{category_id}
Auth: Required (admin only)
```

**Response (200):**
```json
{
  "message": "Category deleted successfully"
}
```

**Errors:**
- 400: Cannot delete category with items
- 404: Category not found

---

### Inventory Items (7 endpoints)

#### 5. Get All Inventory Items
```
GET /api/v1/inventory/items
Auth: Not required

Query Parameters:
- category_id (optional): Filter by category
- is_active (optional): true/false, default: true
- low_stock (optional): true to show only low stock items
- search (optional): Search in name
```

**Response (200):**
```json
{
  "items": [
    {
      "id": 1,
      "name": "Milk",
      "unit": "L",
      "current_quantity": 15.5,
      "min_threshold": 10.0,
      "cost_per_unit": 60.00,
      "category_id": 1,
      "category_name": "Dairy",
      "is_active": true,
      "is_low_stock": false,
      "created_at": "2025-11-11T09:00:00",
      "updated_at": "2025-11-11T18:00:00"
    },
    {
      "id": 2,
      "name": "Flour",
      "unit": "kg",
      "current_quantity": 3.0,
      "min_threshold": 5.0,
      "cost_per_unit": 45.00,
      "category_id": 2,
      "category_name": "Grains",
      "is_active": true,
      "is_low_stock": true,
      "created_at": "2025-11-11T09:00:00",
      "updated_at": "2025-11-11T18:00:00"
    }
  ],
  "total": 2,
  "low_stock_count": 1
}
```

---

#### 6. Get Single Item
```
GET /api/v1/inventory/items/{item_id}
Auth: Not required
```

**Response (200):**
```json
{
  "id": 1,
  "name": "Milk",
  "unit": "L",
  "current_quantity": 15.5,
  "min_threshold": 10.0,
  "cost_per_unit": 60.00,
  "category_id": 1,
  "category_name": "Dairy",
  "is_active": true,
  "is_low_stock": false,
  "created_at": "2025-11-11T09:00:00",
  "updated_at": "2025-11-11T18:00:00",
  "recent_transactions": [
    {
      "id": 10,
      "transaction_type": "USAGE",
      "quantity": -5.0,
      "recorded_by": "kitchen_staff",
      "created_at": "2025-11-11T18:00:00"
    }
  ]
}
```

---

#### 7. Create Item
```
POST /api/v1/inventory/items
Auth: Required (admin only)
```

**Request:**
```json
{
  "name": "Eggs",
  "unit": "pcs",
  "current_quantity": 50,
  "min_threshold": 20,
  "cost_per_unit": 7.50,
  "category_id": 1
}
```

**Response (201):**
```json
{
  "id": 3,
  "name": "Eggs",
  "unit": "pcs",
  "current_quantity": 50.0,
  "min_threshold": 20.0,
  "cost_per_unit": 7.50,
  "category_id": 1,
  "is_active": true,
  "created_at": "2025-11-11T10:00:00"
}
```

**Errors:**
- 400: Item name already exists in this category
- 400: Invalid unit
- 400: Negative quantities

---

#### 8. Update Item
```
PATCH /api/v1/inventory/items/{item_id}
Auth: Required (admin only)
```

**Request (partial update allowed):**
```json
{
  "min_threshold": 25.0,
  "cost_per_unit": 8.00
}
```

**Response (200):**
```json
{
  "id": 3,
  "name": "Eggs",
  "unit": "pcs",
  "current_quantity": 50.0,
  "min_threshold": 25.0,
  "cost_per_unit": 8.00,
  "category_id": 1,
  "updated_at": "2025-11-11T11:00:00"
}
```

**Note:** current_quantity cannot be updated via this endpoint (use transactions)

---

#### 9. Delete Item (Soft)
```
DELETE /api/v1/inventory/items/{item_id}
Auth: Required (admin only)
```

**Response (200):**
```json
{
  "message": "Item deactivated successfully"
}
```

Sets `is_active = false`. Transaction history preserved.

---

#### 10. Get Low Stock Items
```
GET /api/v1/inventory/items/low-stock
Auth: Required (admin only)
```

**Response (200):**
```json
{
  "low_stock_items": [
    {
      "id": 2,
      "name": "Flour",
      "unit": "kg",
      "current_quantity": 3.0,
      "min_threshold": 5.0,
      "percentage_remaining": 60.0,
      "category_name": "Grains"
    },
    {
      "id": 5,
      "name": "Cheese",
      "unit": "g",
      "current_quantity": 200.0,
      "min_threshold": 500.0,
      "percentage_remaining": 40.0,
      "category_name": "Dairy"
    }
  ],
  "count": 2
}
```

Sorted by urgency (lowest percentage_remaining first)

---

#### 11. Bulk Get Items
```
POST /api/v1/inventory/items/bulk
Auth: Not required
```

**Request:**
```json
{
  "item_ids": [1, 2, 3]
}
```

**Response (200):**
```json
{
  "items": [
    {...}, {...}, {...}
  ]
}
```

Useful for mobile app to fetch specific items for usage recording.

---

### Inventory Transactions (4 endpoints)

#### 12. Record Purchase
```
POST /api/v1/inventory/transactions/purchase
Auth: Required (admin only)
```

**Request:**
```json
{
  "items": [
    {
      "item_id": 1,
      "quantity": 20.0,
      "notes": "Supplier: ABC Dairy"
    },
    {
      "item_id": 2,
      "quantity": 10.0,
      "notes": "Supplier: XYZ Grains"
    }
  ]
}
```

**Response (201):**
```json
{
  "message": "Purchase recorded successfully",
  "transactions": [
    {
      "id": 15,
      "item_id": 1,
      "item_name": "Milk",
      "transaction_type": "PURCHASE",
      "quantity": 20.0,
      "previous_quantity": 15.5,
      "new_quantity": 35.5,
      "recorded_by": "admin",
      "created_at": "2025-11-11T12:00:00"
    },
    {
      "id": 16,
      "item_id": 2,
      "item_name": "Flour",
      "transaction_type": "PURCHASE",
      "quantity": 10.0,
      "previous_quantity": 3.0,
      "new_quantity": 13.0,
      "recorded_by": "admin",
      "created_at": "2025-11-11T12:00:00"
    }
  ]
}
```

**Errors:**
- 400: Invalid item_id
- 400: Negative quantity
- 400: Item not active

---

#### 13. Record Usage
```
POST /api/v1/inventory/transactions/usage
Auth: Not required (open for kitchen staff)
```

**Request:**
```json
{
  "items": [
    {
      "item_id": 1,
      "quantity": 8.0,
      "notes": "End of day count"
    },
    {
      "item_id": 3,
      "quantity": 24,
      "notes": "Used for breakfast service"
    }
  ],
  "recorded_by": "kitchen_staff"
}
```

**Response (201):**
```json
{
  "message": "Usage recorded successfully",
  "transactions": [
    {
      "id": 17,
      "item_id": 1,
      "item_name": "Milk",
      "transaction_type": "USAGE",
      "quantity": -8.0,
      "previous_quantity": 35.5,
      "new_quantity": 27.5,
      "recorded_by": "kitchen_staff",
      "created_at": "2025-11-11T22:00:00"
    },
    {
      "id": 18,
      "item_id": 3,
      "item_name": "Eggs",
      "transaction_type": "USAGE",
      "quantity": -24.0,
      "previous_quantity": 50.0,
      "new_quantity": 26.0,
      "recorded_by": "kitchen_staff",
      "created_at": "2025-11-11T22:00:00"
    }
  ],
  "warnings": [
    {
      "item_id": 3,
      "item_name": "Eggs",
      "message": "Now below threshold (26/20)"
    }
  ]
}
```

**Business Logic:**
- If usage would make quantity negative, allow but show warning
- If usage brings quantity below threshold, include in warnings

---

#### 14. Record Adjustment
```
POST /api/v1/inventory/transactions/adjustment
Auth: Required (admin only)
```

**Request:**
```json
{
  "item_id": 2,
  "new_quantity": 12.5,
  "notes": "Physical count correction"
}
```

**Response (201):**
```json
{
  "id": 19,
  "item_id": 2,
  "item_name": "Flour",
  "transaction_type": "ADJUSTMENT",
  "quantity": -0.5,
  "previous_quantity": 13.0,
  "new_quantity": 12.5,
  "recorded_by": "admin",
  "notes": "Physical count correction",
  "created_at": "2025-11-11T16:00:00"
}
```

**Errors:**
- 400: Notes required for adjustments
- 400: New quantity cannot be negative

---

#### 15. Get Transaction History
```
GET /api/v1/inventory/transactions
Auth: Required (admin only)

Query Parameters:
- item_id (optional): Filter by item
- transaction_type (optional): PURCHASE, USAGE, ADJUSTMENT
- date_from (optional): YYYY-MM-DD
- date_to (optional): YYYY-MM-DD
- recorded_by (optional): Username filter
- limit (optional): default 50, max 200
- offset (optional): default 0
```

**Response (200):**
```json
{
  "transactions": [
    {
      "id": 19,
      "item_id": 2,
      "item_name": "Flour",
      "transaction_type": "ADJUSTMENT",
      "quantity": -0.5,
      "previous_quantity": 13.0,
      "new_quantity": 12.5,
      "notes": "Physical count correction",
      "recorded_by": "admin",
      "created_at": "2025-11-11T16:00:00"
    },
    {
      "id": 18,
      "item_id": 3,
      "item_name": "Eggs",
      "transaction_type": "USAGE",
      "quantity": -24.0,
      "previous_quantity": 50.0,
      "new_quantity": 26.0,
      "notes": "Used for breakfast service",
      "recorded_by": "kitchen_staff",
      "created_at": "2025-11-11T22:00:00"
    }
  ],
  "total": 52,
  "limit": 50,
  "offset": 0
}
```

---

### Daily Cash Counter (5 endpoints)

#### 16. Open Cash Counter
```
POST /api/v1/cash-counter/open
Auth: Required (admin only)
```

**Request:**
```json
{
  "date": "2025-11-11",
  "opening_balance": 5000.00,
  "notes": "New currency notes from bank"
}
```

**Response (201):**
```json
{
  "id": 1,
  "date": "2025-11-11",
  "opening_balance": 5000.00,
  "notes": "New currency notes from bank",
  "opened_by": "admin",
  "opened_at": "2025-11-11T09:00:00",
  "status": "open"
}
```

**Errors:**
- 400: Counter already open for this date
- 400: Date cannot be in the future
- 400: Opening balance must be >= 0

---

#### 17. Close Cash Counter
```
POST /api/v1/cash-counter/close
Auth: Required (admin only)
```

**Request:**
```json
{
  "date": "2025-11-11",
  "closing_balance": 12300.00,
  "notes": "â‚¹200 discrepancy - investigated"
}
```

**Response (200):**
```json
{
  "id": 1,
  "date": "2025-11-11",
  "opening_balance": 5000.00,
  "closing_balance": 12300.00,
  "expected_closing": 12500.00,
  "variance": -200.00,
  "cash_payments_total": 7500.00,
  "notes": "â‚¹200 discrepancy - investigated",
  "closed_by": "admin",
  "closed_at": "2025-11-11T22:00:00",
  "status": "closed_pending_verification"
}
```

**Calculation:**
```
cash_payments_total = SUM(payments.amount WHERE payment_method = 'CASH' AND date = counter.date)
expected_closing = opening_balance + cash_payments_total
variance = closing_balance - expected_closing
```

**Errors:**
- 404: Counter not found for this date
- 400: Counter not open
- 400: Counter already closed

---

#### 18. Verify Cash Counter
```
POST /api/v1/cash-counter/verify/{counter_id}
Auth: Required (admin must provide owner password)
```

**Request:**
```json
{
  "owner_password": "owner_secret_password"
}
```

**Response (200):**
```json
{
  "id": 1,
  "date": "2025-11-11",
  "opening_balance": 5000.00,
  "closing_balance": 12300.00,
  "expected_closing": 12500.00,
  "variance": -200.00,
  "verified_by": "owner",
  "verified_at": "2025-11-11T23:00:00",
  "status": "verified"
}
```

**Backend Verification:**
```python
from passlib.context import CryptContext

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

# In config.py
OWNER_PASSWORD_HASH = os.getenv("OWNER_PASSWORD_HASH")

# In endpoint
def verify_cash_counter(owner_password: str):
    if not pwd_context.verify(owner_password, settings.OWNER_PASSWORD_HASH):
        raise HTTPException(401, "Incorrect owner password")
    
    # Mark as verified
    counter.is_verified = True
    counter.verified_by = "owner"
    counter.verified_at = datetime.now()
```

**Errors:**
- 401: Incorrect owner password
- 404: Counter not found
- 400: Counter not closed yet
- 400: Counter already verified

---

#### 19. Get Today's Cash Counter
```
GET /api/v1/cash-counter/today
Auth: Required (admin only)
```

**Response (200):**
```json
{
  "id": 1,
  "date": "2025-11-11",
  "opening_balance": 5000.00,
  "closing_balance": null,
  "expected_closing": null,
  "cash_payments_total": 3250.00,
  "opened_by": "admin",
  "opened_at": "2025-11-11T09:00:00",
  "status": "open"
}
```

If not opened yet:
```json
{
  "message": "Cash counter not opened for today",
  "date": "2025-11-11",
  "suggested_opening_balance": 5000.00
}
```

`suggested_opening_balance` = previous day's closing balance (if available)

---

#### 20. Get Cash Counter History
```
GET /api/v1/cash-counter/history
Auth: Required (admin only)

Query Parameters:
- date_from (optional): YYYY-MM-DD
- date_to (optional): YYYY-MM-DD
- status (optional): open, closed_pending_verification, verified
- limit (optional): default 30
- offset (optional): default 0
```

**Response (200):**
```json
{
  "counters": [
    {
      "id": 1,
      "date": "2025-11-11",
      "opening_balance": 5000.00,
      "closing_balance": 12300.00,
      "expected_closing": 12500.00,
      "variance": -200.00,
      "status": "verified",
      "opened_by": "admin",
      "closed_by": "admin",
      "verified_by": "owner",
      "verified_at": "2025-11-11T23:00:00"
    },
    {
      "id": 2,
      "date": "2025-11-10",
      "opening_balance": 5000.00,
      "closing_balance": 11800.00,
      "expected_closing": 11900.00,
      "variance": -100.00,
      "status": "verified",
      "opened_by": "admin",
      "closed_by": "admin",
      "verified_by": "owner",
      "verified_at": "2025-11-10T22:30:00"
    }
  ],
  "total": 15,
  "limit": 30,
  "offset": 0,
  "summary": {
    "total_variance": -300.00,
    "average_variance": -20.00,
    "unverified_count": 0
  }
}
```

---

## ğŸŒ™ Dark Mode Implementation Guide

### Step-by-Step Development Plan

Since dark mode is Feature 0 (warm-up before inventory), here's the recommended implementation order:

#### **Phase 1: Foundation (Day 1)**

**1.1 Update Tailwind Config**
```javascript
// frontend/tailwind.config.js
module.exports = {
  darkMode: 'class', // Add this line
  // ... rest of config
}
```

**1.2 Create Theme Context**
```bash
# Create new file
touch frontend/src/contexts/ThemeContext.tsx
```

Implementation in `ThemeContext.tsx`:
- useState for theme state
- localStorage integration
- System preference detection
- useEffect to apply class to html element
- Export ThemeProvider and useTheme hook

**1.3 Wrap App with Provider**
```tsx
// frontend/src/main.tsx or App.tsx
import { ThemeProvider } from './contexts/ThemeContext';

<ThemeProvider>
  <App />
</ThemeProvider>
```

---

#### **Phase 2: Toggle Component (Day 1-2)**

**2.1 Create ThemeToggle Component**
```bash
touch frontend/src/components/ThemeToggle.tsx
```

Implementation:
- Use useTheme hook
- Render Sun/Moon icon based on theme
- Handle click to toggle
- Add hover states and transitions

**2.2 Add Icons**
```bash
# If using lucide-react (already in project)
# Icons already available: Sun, Moon
```

**2.3 Add Toggle to UI**
Update these components:
- `Sidebar.tsx` - Add toggle button in header
- `BottomNav.tsx` - Add toggle in profile/settings area (mobile)

---

#### **Phase 3: Style Existing Pages (Day 2-3)**

**3.1 Update Global Styles**
```css
/* frontend/src/index.css */
@layer base {
  :root {
    /* Light mode variables */
  }
  
  .dark {
    /* Dark mode variables */
  }
}
```

**3.2 Update Component Styles (Priority Order)**

1. **Layout Components:**
   - `Sidebar.tsx`
   - `BottomNav.tsx`
   - `FloatingCartButton.tsx`

2. **Common Components:**
   - Buttons (all variants)
   - Cards
   - Modals
   - Forms (inputs, selects, textareas)
   - Tables

3. **Page Components:**
   - `TablesPage.tsx`
   - `OrderPage.tsx`
   - `ActiveOrdersPage.tsx`
   - `MenuManagementPage.tsx`
   - `OrderHistoryPage.tsx`
   - `AdminDashboard.tsx`
   - `LoginPage.tsx`

**Pattern to Follow:**
```tsx
// Before (light mode only)
<div className="bg-white border-gray-200 text-gray-900">

// After (dark mode support)
<div className="
  bg-white dark:bg-gray-800
  border-gray-200 dark:border-gray-700
  text-gray-900 dark:text-gray-100
">
```

---

#### **Phase 4: Testing & Polish (Day 3-4)**

**4.1 Visual Testing**
- Test all pages in both themes
- Check contrast ratios
- Verify transitions are smooth
- Test on mobile devices

**4.2 Edge Cases**
- Test localStorage persistence
- Test system preference detection
- Test theme toggle in multiple tabs
- Test with browser DevTools (force dark mode)

**4.3 Accessibility**
- Run axe DevTools in both themes
- Verify WCAG AA contrast ratios
- Test with screen readers
- Ensure toggle button has aria-label

**4.4 Performance**
- Verify no layout shift on theme change
- Check transition performance
- Test localStorage read/write speed

---

### Common Patterns & Best Practices

#### **Color Class Patterns**

```tsx
// Backgrounds
bg-white dark:bg-gray-800
bg-gray-50 dark:bg-gray-900
bg-gray-100 dark:bg-gray-800

// Text
text-gray-900 dark:text-gray-100
text-gray-600 dark:text-gray-400
text-gray-500 dark:text-gray-500

// Borders
border-gray-200 dark:border-gray-700
border-gray-300 dark:border-gray-600

// Shadows
shadow-sm dark:shadow-gray-900/50
shadow-md dark:shadow-gray-900/75

// Hover states
hover:bg-gray-100 dark:hover:bg-gray-700
hover:text-gray-900 dark:hover:text-gray-100

// Focus rings
focus:ring-lily-green dark:focus:ring-lily-green-light
```

#### **Coffee Theme Colors**

```tsx
// Primary actions (buttons, links)
bg-lily-green dark:bg-lily-green-light
text-lily-green dark:text-lily-green-light

// Accents (headers, highlights)
bg-lily-brown dark:bg-lily-brown-light
text-lily-brown dark:text-lily-brown-light

// Backgrounds (cards, sections)
bg-lily-cream dark:bg-lily-cream-dark
```

#### **Status Colors (Same in Both Modes)**

```tsx
// Success
text-green-600 dark:text-green-500
bg-green-50 dark:bg-green-900/20

// Warning
text-yellow-600 dark:text-yellow-500
bg-yellow-50 dark:bg-yellow-900/20

// Error
text-red-600 dark:text-red-500
bg-red-50 dark:bg-red-900/20

// Info
text-blue-600 dark:text-blue-500
bg-blue-50 dark:bg-blue-900/20
```

---

### Troubleshooting Guide

**Issue: Theme flashes on page load**
```tsx
// Solution: Add theme class to HTML immediately
// In index.html <head>:
<script>
  const theme = localStorage.getItem('theme') || 
    (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
  document.documentElement.classList.toggle('dark', theme === 'dark');
</script>
```

**Issue: Some components still show light colors in dark mode**
```tsx
// Solution: Check for hardcoded colors or missing dark: classes
// Bad:
<div className="bg-white">

// Good:
<div className="bg-white dark:bg-gray-800">
```

**Issue: Poor contrast in dark mode**
```tsx
// Solution: Use lighter text on dark backgrounds
// Bad:
<div className="dark:bg-gray-800 dark:text-gray-800">

// Good:
<div className="dark:bg-gray-800 dark:text-gray-100">
```

**Issue: localStorage not persisting**
```tsx
// Solution: Ensure setTheme updates localStorage
const setTheme = (newTheme: Theme) => {
  setThemeState(newTheme);
  localStorage.setItem('theme', newTheme); // Don't forget this!
  document.documentElement.classList.toggle('dark', newTheme === 'dark');
};
```

---

### Files to Create/Modify

**New Files (2):**
1. `frontend/src/contexts/ThemeContext.tsx` (~80 lines)
2. `frontend/src/components/ThemeToggle.tsx` (~30 lines)

**Modified Files (~15):**
- `frontend/tailwind.config.js` (1 line change)
- `frontend/src/main.tsx` or `App.tsx` (wrap with provider)
- `frontend/src/index.css` (add dark mode CSS variables)
- `frontend/src/components/Sidebar.tsx` (add toggle)
- `frontend/src/components/BottomNav.tsx` (add toggle)
- All page components (add dark: classes)
- All reusable components (add dark: classes)

**Total Effort:** ~1-2 days focused work

---

## ğŸ”„ User Flows

### Flow 0: User Toggles Dark Mode

```
1. User opens app (any page)
2. Initial theme applied:
   - If localStorage has theme â†’ Use it
   - Else if system prefers dark â†’ Use dark
   - Else â†’ Use light (default)
3. User wants to switch theme
4. Desktop: Clicks theme toggle button in sidebar header
   OR
   Mobile: Taps theme toggle in bottom nav
5. Theme switches immediately:
   - All colors update smoothly (200ms transition)
   - Icon changes (Sun â†” Moon)
   - Preference saved to localStorage
6. User navigates to another page
7. Theme persists (no flash of wrong theme)
8. User closes browser
9. User reopens app later
10. Theme is remembered (persists across sessions)
```

**Visual Feedback:**
```
Light Mode:                 Dark Mode:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜€ï¸ Toggle           â”‚    â”‚ ğŸŒ™ Toggle           â”‚
â”‚ (Moon icon shows)   â”‚    â”‚ (Sun icon shows)    â”‚
â”‚                     â”‚    â”‚                     â”‚
â”‚ White backgrounds   â”‚    â”‚ Dark backgrounds    â”‚
â”‚ Dark text           â”‚    â”‚ Light text          â”‚
â”‚ Light shadows       â”‚    â”‚ Dark shadows        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Flow 1: Admin Adds New Inventory Item

```
1. Admin logs in â†’ Dashboard
2. Sidebar: Click "Inventory Management"
3. Lands on Inventory Items page
4. Click [+ Add Item] button
5. Modal/form appears:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Add Inventory Item          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Name: [____________]        â”‚
   â”‚ Unit: [dropdown: L/kg/pcs]  â”‚
   â”‚ Category: [dropdown]        â”‚
   â”‚ Current Qty: [_____]        â”‚
   â”‚ Min Threshold: [_____]      â”‚
   â”‚ Cost/Unit (â‚¹): [_____]      â”‚
   â”‚                             â”‚
   â”‚      [Cancel] [Add Item]    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
6. Fill form
7. Click [Add Item]
8. Toast: "Item added successfully"
9. Item appears in list
```

---

### Flow 2: Admin Records Purchase

```
1. Admin receives supplier delivery
2. Inventory Management â†’ Click [Record Purchase] button
3. Purchase form appears:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Record Purchase             â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Select Items:               â”‚
   â”‚ [Search items...]           â”‚
   â”‚                             â”‚
   â”‚ Selected Items:             â”‚
   â”‚ â€¢ Milk: [20] L              â”‚
   â”‚   Notes: [Supplier ABC...]  â”‚
   â”‚ â€¢ Flour: [10] kg            â”‚
   â”‚   Notes: [____________]     â”‚
   â”‚                             â”‚
   â”‚ [+ Add More Items]          â”‚
   â”‚                             â”‚
   â”‚  [Cancel] [Record Purchase] â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
4. Click [Record Purchase]
5. Toast: "Purchase recorded. 2 items updated."
6. Quantities updated in inventory list
```

---

### Flow 3: Kitchen Staff Records Daily Usage (Mobile)

```
1. End of shift: Open app on phone
2. Lands on Tables page (default)
3. Bottom nav: Tap "Usage" icon
4. Usage Recording page:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Record Daily Usage          â”‚
   â”‚ [Search items...      ]     â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Dairy                       â”‚
   â”‚  â€¢ Milk (L)                 â”‚
   â”‚    Current: 27.5L           â”‚
   â”‚    Used: [8] L              â”‚
   â”‚  â€¢ Eggs (pcs)               â”‚
   â”‚    Current: 26              â”‚
   â”‚    Used: [24] pcs           â”‚
   â”‚                             â”‚
   â”‚ Grains                      â”‚
   â”‚  â€¢ Flour (kg)               â”‚
   â”‚    Current: 12.5kg          â”‚
   â”‚    Used: [2] kg             â”‚
   â”‚                             â”‚
   â”‚ [Submit Usage]              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
5. Enter quantities used
6. Tap [Submit Usage]
7. Confirmation dialog:
   "Submit usage for 3 items?"
   [Cancel] [Confirm]
8. Tap [Confirm]
9. Toast: "Usage recorded successfully"
10. Form clears, ready for next day
```

**Mobile Optimizations:**
- Large touch targets (48px min)
- Number pad for quantity input
- Grouped by category (collapsible)
- Search at top
- Common items pinned to top
- Works offline, syncs when online

---

### Flow 4: Admin Makes Physical Count Adjustment

```
1. Admin performs physical inventory count
2. Inventory Management page
3. Find item "Flour" in list
4. Click [...] menu â†’ "Adjust Quantity"
5. Adjustment modal:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Adjust Inventory - Flour    â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Current in system: 12.5 kg  â”‚
   â”‚ Physical count: [11.5] kg   â”‚
   â”‚                             â”‚
   â”‚ Difference: -1.0 kg âš ï¸      â”‚
   â”‚                             â”‚
   â”‚ Reason (required):          â”‚
   â”‚ [Physical count found       â”‚
   â”‚  slight discrepancy]        â”‚
   â”‚                             â”‚
   â”‚    [Cancel] [Adjust]        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
6. Enter actual count and reason
7. Click [Adjust]
8. Toast: "Inventory adjusted"
9. Transaction recorded in history
```

---

### Flow 5: Admin Views Low Stock Alerts

```
1. Admin logs in â†’ Lands on Dashboard
2. Sees alert card:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ âš ï¸ Low Stock Items (2)      â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ ğŸ¥› Milk - 2L left           â”‚
   â”‚    Threshold: 5L (40%)      â”‚
   â”‚    [Order Now]              â”‚
   â”‚                             â”‚
   â”‚ ğŸ§€ Cheese - 200g left       â”‚
   â”‚    Threshold: 500g (40%)    â”‚
   â”‚    [Order Now]              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
3. Click [Order Now] â†’ Opens purchase form with item pre-selected
OR
3. Click card â†’ Goes to Inventory page filtered to low stock items
```

---

### Flow 6: Admin Opens Daily Cash Counter

```
1. Admin arrives at cafe in morning
2. Logs in â†’ Dashboard
3. Sees cash counter card:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ’° Cash Counter             â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Status: Not Opened          â”‚
   â”‚ Date: Nov 11, 2025          â”‚
   â”‚                             â”‚
   â”‚ Suggested opening: â‚¹5,000   â”‚
   â”‚ (yesterday's closing)       â”‚
   â”‚                             â”‚
   â”‚     [Open Counter]          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
4. Click [Open Counter]
5. Modal appears:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Open Cash Counter           â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Date: Nov 11, 2025          â”‚
   â”‚                             â”‚
   â”‚ Count cash in drawer:       â”‚
   â”‚ Opening Balance: [5000] â‚¹   â”‚
   â”‚                             â”‚
   â”‚ Notes (optional):           â”‚
   â”‚ [New notes from bank___]    â”‚
   â”‚                             â”‚
   â”‚     [Cancel] [Open]         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
6. Count physical cash, enter amount
7. Click [Open]
8. Toast: "Cash counter opened"
9. Card updates to show "Open" status
```

---

### Flow 7: Admin Closes Daily Cash Counter

```
1. End of day: Admin clicks "Cash Counter" card
2. Counter detail view:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Cash Counter - Nov 11       â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Status: Open                â”‚
   â”‚                             â”‚
   â”‚ Opening: â‚¹5,000             â”‚
   â”‚ Cash Sales Today: â‚¹7,500    â”‚
   â”‚ Expected Closing: â‚¹12,500   â”‚
   â”‚                             â”‚
   â”‚     [Close Counter]         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
3. Click [Close Counter]
4. Closing modal:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Close Cash Counter          â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Expected: â‚¹12,500           â”‚
   â”‚                             â”‚
   â”‚ Count cash in drawer:       â”‚
   â”‚ Actual Closing: [12300] â‚¹   â”‚
   â”‚                             â”‚
   â”‚ Variance: -â‚¹200 âš ï¸          â”‚
   â”‚                             â”‚
   â”‚ Notes (optional):           â”‚
   â”‚ [â‚¹200 short - investigated] â”‚
   â”‚                             â”‚
   â”‚     [Cancel] [Close]        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
5. Count physical cash, enter amount
6. System auto-calculates variance
7. Add notes if significant variance
8. Click [Close]
9. Toast: "Cash counter closed. Pending owner verification."
10. Status updates to "Closed - Pending Verification"
```

---

### Flow 8: Owner Verifies Cash Counter

```
1. Owner logs in (or admin user with owner access)
2. Dashboard shows:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ğŸ’° Cash Counter             â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Status: Pending Verificationâ”‚
   â”‚ Date: Nov 11, 2025          â”‚
   â”‚                             â”‚
   â”‚ Opening: â‚¹5,000             â”‚
   â”‚ Closing: â‚¹12,300            â”‚
   â”‚ Expected: â‚¹12,500           â”‚
   â”‚ Variance: -â‚¹200 âš ï¸          â”‚
   â”‚                             â”‚
   â”‚ Closed by: admin            â”‚
   â”‚                             â”‚
   â”‚      [âœ“ Verify]             â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
3. Click [âœ“ Verify]
4. Password prompt modal:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Verify Cash Counter         â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ Enter owner password to     â”‚
   â”‚ verify today's cash count   â”‚
   â”‚                             â”‚
   â”‚ Password: [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢]        â”‚
   â”‚                             â”‚
   â”‚     [Cancel] [Verify]       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
5. Enter owner password
6. Click [Verify]
7. If correct:
   - Toast: "Cash counter verified"
   - Status updates to "Verified âœ…"
   - Verified timestamp recorded
8. If incorrect:
   - Toast: "Incorrect password"
   - Modal stays open, can retry
```

---

## ğŸ¨ Component Specifications

### Frontend Components (16 new + updates)

#### 0. Dark Mode Components

##### ThemeProvider.tsx
**Location:** `frontend/src/contexts/ThemeContext.tsx`  
**Type:** React Context Provider

**State:**
```typescript
type Theme = 'light' | 'dark';

interface ThemeContextType {
  theme: Theme;
  toggleTheme: () => void;
  setTheme: (theme: Theme) => void;
}

const ThemeContext = createContext<ThemeContextType | undefined>(undefined);

export function ThemeProvider({ children }: { children: ReactNode }) {
  const [theme, setThemeState] = useState<Theme>(() => {
    // 1. Check localStorage
    const stored = localStorage.getItem('theme');
    if (stored === 'light' || stored === 'dark') return stored;
    
    // 2. Check system preference
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    }
    
    // 3. Default to light
    return 'light';
  });
  
  const setTheme = (newTheme: Theme) => {
    setThemeState(newTheme);
    localStorage.setItem('theme', newTheme);
    document.documentElement.classList.toggle('dark', newTheme === 'dark');
  };
  
  const toggleTheme = () => {
    setTheme(theme === 'light' ? 'dark' : 'light');
  };
  
  useEffect(() => {
    document.documentElement.classList.toggle('dark', theme === 'dark');
  }, []);
  
  return (
    <ThemeContext.Provider value={{ theme, toggleTheme, setTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}

export function useTheme() {
  const context = useContext(ThemeContext);
  if (!context) throw new Error('useTheme must be used within ThemeProvider');
  return context;
}
```

---

##### ThemeToggle.tsx
**Location:** `frontend/src/components/ThemeToggle.tsx`  
**Type:** Button Component

**Props:**
```typescript
interface Props {
  className?: string;
}
```

**UI:**
```tsx
export function ThemeToggle({ className }: Props) {
  const { theme, toggleTheme } = useTheme();
  
  return (
    <button
      onClick={toggleTheme}
      className={cn(
        "p-2 rounded-lg transition-colors",
        "hover:bg-gray-100 dark:hover:bg-gray-800",
        className
      )}
      aria-label="Toggle theme"
    >
      {theme === 'light' ? (
        <MoonIcon className="w-5 h-5" />
      ) : (
        <SunIcon className="w-5 h-5" />
      )}
    </button>
  );
}
```

**Placement:**
- Admin sidebar (top right)
- Mobile bottom nav (settings/profile area)
- Desktop header (near user menu)

---

#### 1. InventoryCategoriesPage.tsx
**Location:** `frontend/src/pages/InventoryCategoriesPage.tsx`  
**Route:** `/admin/inventory/categories`  
**Auth:** Required

**State:**
```typescript
const [categories, setCategories] = useState<InventoryCategory[]>([]);
const [showAddModal, setShowAddModal] = useState(false);
const [editingCategory, setEditingCategory] = useState<InventoryCategory | null>(null);
```

**Layout:**
- Header with [+ Add Category] button
- Categories list (cards or table)
- Each category shows:
  - Name
  - Item count
  - Edit/Delete actions

**Actions:**
- Add new category
- Edit category name
- Delete category (with confirmation)

---

#### 2. InventoryItemsPage.tsx
**Location:** `frontend/src/pages/InventoryItemsPage.tsx`  
**Route:** `/admin/inventory/items`  
**Auth:** Required

**State:**
```typescript
const [items, setItems] = useState<InventoryItem[]>([]);
const [filters, setFilters] = useState({
  category_id: null,
  search: '',
  low_stock: false
});
const [showAddModal, setShowAddModal] = useState(false);
const [editingItem, setEditingItem] = useState<InventoryItem | null>(null);
```

**Layout:**
- Header with [+ Add Item] and [Record Purchase] buttons
- Filters: Category dropdown, search input, "Low Stock Only" checkbox
- Items grid/table:
  - Name
  - Current quantity (with unit)
  - Threshold
  - Category
  - Status (Low Stock indicator)
  - Actions menu

**Features:**
- Search and filter
- Sort by name, category, quantity
- Low stock visual indicators (red/yellow)
- Quick actions menu per item

---

#### 3. InventoryItemForm.tsx
**Location:** `frontend/src/components/InventoryItemForm.tsx`  
**Type:** Modal/Form Component

**Props:**
```typescript
interface Props {
  item?: InventoryItem; // undefined for create, populated for edit
  categories: InventoryCategory[];
  onSave: (item: InventoryItemCreate | InventoryItemUpdate) => Promise<void>;
  onCancel: () => void;
}
```

**Fields:**
- Name (text, required)
- Unit (select: L, kg, pcs, g, ml)
- Category (select from categories)
- Current Quantity (number, required, >= 0)
- Min Threshold (number, required, >= 0)
- Cost per Unit (number, optional, >= 0)

**Validation:**
- All required fields filled
- Quantities are valid numbers
- Name not empty

---

#### 4. RecordPurchaseModal.tsx
**Location:** `frontend/src/components/RecordPurchaseModal.tsx`  
**Type:** Modal Component

**State:**
```typescript
const [selectedItems, setSelectedItems] = useState<PurchaseItem[]>([]);
const [searchQuery, setSearchQuery] = useState('');

interface PurchaseItem {
  item_id: number;
  item_name: string;
  current_quantity: number;
  unit: string;
  quantity: number; // Amount to purchase
  notes: string;
}
```

**Layout:**
- Search bar to find items
- Selected items list (can add multiple)
- Each selected item:
  - Name + current quantity
  - Quantity input
  - Notes input (optional)
  - Remove button
- [+ Add More Items] button
- [Cancel] [Record Purchase] buttons

**Flow:**
1. Search and select items
2. Enter quantities for each
3. Add optional notes
4. Submit â†’ Creates multiple PURCHASE transactions

---

#### 5. RecordUsagePage.tsx (Mobile)
**Location:** `frontend/src/pages/RecordUsagePage.tsx`  
**Route:** `/usage` (accessible without login)  
**Device:** Mobile-optimized

**State:**
```typescript
const [items, setItems] = useState<InventoryItem[]>([]);
const [usageData, setUsageData] = useState<Map<number, number>>(new Map());
const [recordedBy, setRecordedBy] = useState('');
```

**Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Record Daily Usage          â”‚
â”‚ [Search...            ]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Your Name: [__________]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¼ Dairy (2 items)           â”‚
â”‚   ğŸ¥› Milk (L)               â”‚
â”‚      Current: 27.5L         â”‚
â”‚      Used: [  ] L           â”‚
â”‚   ğŸ¥š Eggs (pcs)             â”‚
â”‚      Current: 26            â”‚
â”‚      Used: [  ] pcs         â”‚
â”‚                             â”‚
â”‚ â–¼ Grains (1 item)           â”‚
â”‚   ğŸŒ¾ Flour (kg)             â”‚
â”‚      Current: 12.5kg        â”‚
â”‚      Used: [  ] kg          â”‚
â”‚                             â”‚
â”‚     [Submit Usage]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Features:**
- Grouped by category (collapsible accordions)
- Large touch-friendly inputs
- Number pad optimized
- Shows current quantity for reference
- Only sends items with non-zero usage
- Confirmation dialog before submit

---

#### 6. AdjustInventoryModal.tsx
**Location:** `frontend/src/components/AdjustInventoryModal.tsx`  
**Type:** Modal Component

**Props:**
```typescript
interface Props {
  item: InventoryItem;
  onSave: (adjustment: InventoryAdjustment) => Promise<void>;
  onCancel: () => void;
}
```

**Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Adjust Inventory - Flour    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Current: 12.5 kg            â”‚
â”‚ Physical Count: [   ] kg    â”‚
â”‚                             â”‚
â”‚ Difference: (calculated)    â”‚
â”‚                             â”‚
â”‚ Reason (required):          â”‚
â”‚ [____________________]      â”‚
â”‚                             â”‚
â”‚   [Cancel] [Adjust]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Behavior:**
- Auto-calculates difference
- Shows warning if difference > 20%
- Requires reason/notes
- Validates new quantity >= 0

---

#### 7. LowStockAlertCard.tsx
**Location:** `frontend/src/components/LowStockAlertCard.tsx`  
**Type:** Dashboard Widget

**Props:**
```typescript
interface Props {
  lowStockItems: InventoryItem[];
  onOrderNow: (item: InventoryItem) => void;
}
```

**Display:**
- Only shows if lowStockItems.length > 0
- Shows count in header
- Lists up to 5 items (with "View All" link)
- Each item shows:
  - Icon/emoji
  - Name
  - Current quantity vs threshold
  - Percentage remaining
  - [Order Now] button

**Urgency Colors:**
- Red: < 25% of threshold
- Yellow: 25-50% of threshold
- Orange: 50-75% of threshold

---

#### 8. InventoryTransactionsPage.tsx
**Location:** `frontend/src/pages/InventoryTransactionsPage.tsx`  
**Route:** `/admin/inventory/transactions`  
**Auth:** Required

**Filters:**
```typescript
const [filters, setFilters] = useState({
  item_id: null,
  transaction_type: null,
  date_from: null,
  date_to: null,
  recorded_by: ''
});
```

**Layout:**
- Filters bar (item, type, date range, user)
- Transactions table:
  - Date/Time
  - Item Name
  - Type (badge with color)
  - Quantity (with +/- sign)
  - Previous â†’ New quantity
  - Recorded by
  - Notes

**Features:**
- Sortable columns
- Pagination
- Export to CSV (v0.3)
- Filter by multiple criteria

---

#### 9. CashCounterCard.tsx
**Location:** `frontend/src/components/CashCounterCard.tsx`  
**Type:** Dashboard Widget

**Props:**
```typescript
interface Props {
  counter: DailyCashCounter | null;
  onOpenCounter: () => void;
  onCloseCounter: () => void;
  onVerifyCounter: () => void;
}
```

**Display Variants:**

**A) Not Opened:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’° Cash Counter             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Status: Not Opened          â”‚
â”‚ Date: Nov 11, 2025          â”‚
â”‚                             â”‚
â”‚ Suggested: â‚¹5,000           â”‚
â”‚                             â”‚
â”‚     [Open Counter]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**B) Open:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’° Cash Counter             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Status: Open âœ…             â”‚
â”‚                             â”‚
â”‚ Opening: â‚¹5,000             â”‚
â”‚ Cash Sales: â‚¹3,250          â”‚
â”‚ Expected: â‚¹8,250            â”‚
â”‚                             â”‚
â”‚    [Close Counter]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**C) Closed - Pending:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’° Cash Counter             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Status: Pending â³          â”‚
â”‚                             â”‚
â”‚ Opening: â‚¹5,000             â”‚
â”‚ Closing: â‚¹12,300            â”‚
â”‚ Expected: â‚¹12,500           â”‚
â”‚ Variance: -â‚¹200 âš ï¸          â”‚
â”‚                             â”‚
â”‚      [âœ“ Verify]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**D) Verified:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’° Cash Counter             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Status: Verified âœ…          â”‚
â”‚                             â”‚
â”‚ Opening: â‚¹5,000             â”‚
â”‚ Closing: â‚¹12,300            â”‚
â”‚ Variance: -â‚¹200             â”‚
â”‚                             â”‚
â”‚ Verified by: owner          â”‚
â”‚ at 11:00 PM                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 10. OpenCashCounterModal.tsx
**Location:** `frontend/src/components/OpenCashCounterModal.tsx`

**Props:**
```typescript
interface Props {
  date: string; // YYYY-MM-DD
  suggestedOpening: number | null;
  onSubmit: (data: OpenCounterRequest) => Promise<void>;
  onCancel: () => void;
}
```

**Form Fields:**
- Date (display only, not editable)
- Opening Balance (number input, required)
- Notes (textarea, optional)

---

#### 11. CloseCashCounterModal.tsx
**Location:** `frontend/src/components/CloseCashCounterModal.tsx`

**Props:**
```typescript
interface Props {
  counter: DailyCashCounter;
  expectedClosing: number;
  onSubmit: (data: CloseCounterRequest) => Promise<void>;
  onCancel: () => void;
}
```

**Display:**
- Shows opening balance
- Shows expected closing (calculated)
- Input: Actual closing balance
- Auto-calculates variance
- Variance shown with color (red if significant)
- Notes (textarea, optional but recommended if variance)

---

#### 12. VerifyCashCounterModal.tsx
**Location:** `frontend/src/components/VerifyCashCounterModal.tsx`

**Props:**
```typescript
interface Props {
  counter: DailyCashCounter;
  onSubmit: (ownerPassword: string) => Promise<void>;
  onCancel: () => void;
}
```

**Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Verify Cash Counter         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Date: Nov 11, 2025          â”‚
â”‚ Variance: -â‚¹200             â”‚
â”‚                             â”‚
â”‚ Enter owner password:       â”‚
â”‚ Password: [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢]        â”‚
â”‚                             â”‚
â”‚   [Cancel] [Verify]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Security:**
- Password input type="password"
- No password visibility toggle
- Error handling for incorrect password

---

#### 13. CashCounterHistoryPage.tsx
**Location:** `frontend/src/pages/CashCounterHistoryPage.tsx`  
**Route:** `/admin/cash-counter/history`  
**Auth:** Required

**Filters:**
```typescript
const [filters, setFilters] = useState({
  date_from: null,
  date_to: null,
  status: null
});
```

**Layout:**
- Filters bar
- Summary cards:
  - Total days
  - Average variance
  - Unverified count
- History table:
  - Date
  - Opening
  - Closing
  - Expected
  - Variance (color-coded)
  - Status badge
  - Verified by/at

---

#### 14. InventoryDashboard.tsx
**Location:** `frontend/src/components/InventoryDashboard.tsx`  
**Type:** Dashboard Section

**Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Inventory Overview                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ Total   â”‚ â”‚ Low     â”‚ â”‚ Out of  â”‚â”‚
â”‚ â”‚ Items   â”‚ â”‚ Stock   â”‚ â”‚ Stock   â”‚â”‚
â”‚ â”‚   45    â”‚ â”‚    2    â”‚ â”‚    0    â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                      â”‚
â”‚ Recent Transactions:                 â”‚
â”‚ â€¢ Milk: +20L (Purchase)              â”‚
â”‚ â€¢ Eggs: -24 pcs (Usage)              â”‚
â”‚ â€¢ Flour: Adjusted to 12.5kg          â”‚
â”‚                                      â”‚
â”‚          [View All Items]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Updated Components from v0.1

#### AdminDashboard.tsx - Add Widgets
```typescript
// Add to dashboard:
<LowStockAlertCard />
<CashCounterCard />
<InventoryDashboard />
```

#### Sidebar.tsx - Add Menu Items
```typescript
// Add to admin sidebar:
{
  label: 'Inventory',
  icon: <BoxIcon />,
  subItems: [
    { label: 'Items', path: '/admin/inventory/items' },
    { label: 'Categories', path: '/admin/inventory/categories' },
    { label: 'Transactions', path: '/admin/inventory/transactions' }
  ]
},
{
  label: 'Cash Counter',
  icon: <CurrencyIcon />,
  path: '/admin/cash-counter',
  badge: counter?.status === 'closed_pending_verification' ? '!' : null
}
```

#### BottomNav.tsx - Add Usage Button
```typescript
// Add to waiter bottom navigation:
{
  label: 'Usage',
  icon: <ClipboardIcon />,
  path: '/usage'
}
```

---

## ğŸ¨ UI/UX Design

### Design System Extensions

#### Dark Mode Color Palette

**Base Colors:**
```css
/* Light mode (existing) */
:root {
  /* Coffee theme */
  --lily-brown: #8B4513;
  --lily-cream: #FFF8DC;
  --lily-green: #556B2F;
  --lily-dark-brown: #654321;
  
  /* Backgrounds */
  --bg-primary: #FFFFFF;
  --bg-secondary: #F9FAFB;
  --bg-tertiary: #F3F4F6;
  
  /* Text */
  --text-primary: #111827;
  --text-secondary: #6B7280;
  --text-tertiary: #9CA3AF;
  
  /* Borders */
  --border-light: #E5E7EB;
  --border-medium: #D1D5DB;
  --border-dark: #9CA3AF;
  
  /* Status */
  --success: #10B981;
  --warning: #F59E0B;
  --error: #EF4444;
  --info: #3B82F6;
}

/* Dark mode */
.dark {
  /* Coffee theme - darker variants */
  --lily-brown: #A0522D;
  --lily-cream: #2D2D2D;
  --lily-green: #6B8E23;
  --lily-dark-brown: #4A3728;
  
  /* Backgrounds */
  --bg-primary: #0F172A;
  --bg-secondary: #1E293B;
  --bg-tertiary: #334155;
  
  /* Text */
  --text-primary: #F1F5F9;
  --text-secondary: #CBD5E1;
  --text-tertiary: #94A3B8;
  
  /* Borders */
  --border-light: #334155;
  --border-medium: #475569;
  --border-dark: #64748B;
  
  /* Status - slightly muted in dark mode */
  --success: #10B981;
  --warning: #F59E0B;
  --error: #EF4444;
  --info: #3B82F6;
}
```

**Tailwind Configuration:**
```javascript
// tailwind.config.js
module.exports = {
  darkMode: 'class', // Use class-based dark mode
  theme: {
    extend: {
      colors: {
        'lily-brown': {
          light: '#A0522D',
          DEFAULT: '#8B4513',
          dark: '#654321',
        },
        'lily-cream': {
          light: '#FFFAF0',
          DEFAULT: '#FFF8DC',
          dark: '#2D2D2D',
        },
        'lily-green': {
          light: '#6B8E23',
          DEFAULT: '#556B2F',
          dark: '#4A5D23',
        }
      }
    }
  }
}
```

**Component Class Examples:**
```tsx
// Button
<button className="
  bg-lily-green text-white
  dark:bg-lily-green-light dark:text-gray-900
  hover:bg-lily-green-dark
  dark:hover:bg-lily-green
">
  Click me
</button>

// Card
<div className="
  bg-white dark:bg-gray-800
  border border-gray-200 dark:border-gray-700
  shadow-sm dark:shadow-gray-900/50
">
  Card content
</div>

// Text
<p className="
  text-gray-900 dark:text-gray-100
">
  Body text
</p>

<p className="
  text-gray-600 dark:text-gray-400
">
  Secondary text
</p>
```

---

#### New Colors (Inventory & Cash Counter)
```css
/* Inventory status colors */
--stock-critical: #dc2626;  /* Red - < 25% threshold */
--stock-low: #f59e0b;       /* Orange - 25-50% */
--stock-warning: #eab308;   /* Yellow - 50-75% */
--stock-ok: #22c55e;        /* Green - > 75% */

/* Cash counter colors */
--cash-positive: #22c55e;   /* Surplus */
--cash-negative: #dc2626;   /* Deficit */
--cash-neutral: #64748b;    /* Zero variance */
```

#### Transaction Type Badges
```
PURCHASE: Green badge with â†‘ icon
USAGE: Red badge with â†“ icon
ADJUSTMENT: Orange badge with âš–ï¸ icon
```

#### Status Indicators
```
Open: Blue circle
Closed Pending: Orange circle with clock
Verified: Green circle with checkmark
Low Stock: Red/yellow triangle warning
```

---

### Mobile Optimizations

**Usage Recording Page:**
- Minimum 48px touch targets
- Large number inputs with native number pad
- Sticky header with search
- Sticky submit button at bottom
- Swipe-to-collapse categories
- Pull-to-refresh

**Responsive Breakpoints:**
- Mobile: < 640px (single column, large touch targets)
- Tablet: 640-1024px (2 columns)
- Desktop: > 1024px (multi-column grid)

---

## ğŸ’¼ Business Logic

### Inventory Quantity Updates

**Purchase Transaction:**
```python
def record_purchase(db, item_id, quantity, recorded_by, notes):
    item = get_inventory_item(db, item_id)
    previous_qty = item.current_quantity
    new_qty = previous_qty + quantity
    
    transaction = InventoryTransaction(
        item_id=item_id,
        transaction_type=TransactionType.PURCHASE,
        quantity=quantity,  # Positive
        previous_quantity=previous_qty,
        new_quantity=new_qty,
        recorded_by=recorded_by,
        notes=notes
    )
    
    item.current_quantity = new_qty
    db.add(transaction)
    db.commit()
    
    return transaction
```

**Usage Transaction:**
```python
def record_usage(db, item_id, quantity, recorded_by, notes):
    item = get_inventory_item(db, item_id)
    previous_qty = item.current_quantity
    new_qty = previous_qty - quantity
    
    warnings = []
    if new_qty < 0:
        warnings.append(f"Warning: {item.name} quantity will be negative")
    elif new_qty < item.min_threshold:
        warnings.append(f"Low stock: {item.name} below threshold")
    
    transaction = InventoryTransaction(
        item_id=item_id,
        transaction_type=TransactionType.USAGE,
        quantity=-quantity,  # Negative
        previous_quantity=previous_qty,
        new_quantity=new_qty,
        recorded_by=recorded_by,
        notes=notes
    )
    
    item.current_quantity = new_qty
    db.add(transaction)
    db.commit()
    
    return transaction, warnings
```

**Adjustment Transaction:**
```python
def record_adjustment(db, item_id, new_quantity, recorded_by, notes):
    if not notes:
        raise ValueError("Adjustment requires reason in notes")
    
    item = get_inventory_item(db, item_id)
    previous_qty = item.current_quantity
    difference = new_quantity - previous_qty
    
    transaction = InventoryTransaction(
        item_id=item_id,
        transaction_type=TransactionType.ADJUSTMENT,
        quantity=difference,  # Can be + or -
        previous_quantity=previous_qty,
        new_quantity=new_quantity,
        recorded_by=recorded_by,
        notes=notes
    )
    
    item.current_quantity = new_quantity
    db.add(transaction)
    db.commit()
    
    return transaction
```

---

### Low Stock Detection

```python
def get_low_stock_items(db):
    items = db.query(InventoryItem).filter(
        InventoryItem.is_active == True,
        InventoryItem.current_quantity < InventoryItem.min_threshold
    ).all()
    
    # Calculate urgency
    for item in items:
        item.percentage_remaining = (
            item.current_quantity / item.min_threshold * 100
        ) if item.min_threshold > 0 else 100
    
    # Sort by urgency (lowest percentage first)
    items.sort(key=lambda x: x.percentage_remaining)
    
    return items
```

---

### Cash Counter Calculations

```python
def close_cash_counter(db, date, closing_balance, notes, closed_by):
    counter = get_counter_by_date(db, date)
    
    if not counter or counter.closing_balance is not None:
        raise ValueError("Counter not open or already closed")
    
    # Calculate cash payments for the day
    cash_payments = db.query(func.sum(Payment.amount)).filter(
        Payment.payment_method == PaymentMethod.CASH,
        func.date(Payment.created_at) == date
    ).scalar() or Decimal("0.00")
    
    # Calculate expected closing
    expected_closing = counter.opening_balance + cash_payments
    
    # Calculate variance
    variance = closing_balance - expected_closing
    
    # Update counter
    counter.closing_balance = closing_balance
    counter.expected_closing = expected_closing
    counter.variance = variance
    counter.closed_by = closed_by
    counter.closed_at = datetime.now()
    
    if notes:
        counter.notes = notes
    
    db.commit()
    return counter
```

```python
def verify_cash_counter(db, counter_id, owner_password, current_user):
    counter = get_counter_by_id(db, counter_id)
    
    if counter.closing_balance is None:
        raise ValueError("Counter must be closed before verification")
    
    if counter.is_verified:
        raise ValueError("Counter already verified")
    
    # Verify owner password
    if not pwd_context.verify(owner_password, settings.OWNER_PASSWORD_HASH):
        raise HTTPException(401, "Incorrect owner password")
    
    # Mark as verified
    counter.is_verified = True
    counter.verified_by = "owner"
    counter.verified_at = datetime.now()
    
    db.commit()
    return counter
```

---

## ğŸ§ª Testing Checklist

### Unit Tests

**Dark Mode:**
- [ ] Theme context provides correct initial theme
- [ ] Theme toggles between light and dark
- [ ] Theme persists to localStorage
- [ ] System preference detected on first visit
- [ ] Theme context throws error outside provider

**Inventory Items:**
- [ ] Create item with valid data
- [ ] Create item with duplicate name in same category (should fail)
- [ ] Create item with negative quantity (should fail)
- [ ] Update item details
- [ ] Soft delete item (is_active = false)
- [ ] Get items filtered by category
- [ ] Get items filtered by low_stock
- [ ] Search items by name

**Inventory Categories:**
- [ ] Create category with unique name
- [ ] Create category with duplicate name (should fail)
- [ ] Update category name
- [ ] Delete category with no items
- [ ] Delete category with items (should fail)

**Inventory Transactions:**
- [ ] Record purchase increases quantity
- [ ] Record usage decreases quantity
- [ ] Record adjustment to specific quantity
- [ ] Usage below zero shows warning but succeeds
- [ ] Usage below threshold triggers warning
- [ ] Adjustment without notes fails
- [ ] Transaction history filters correctly
- [ ] Audit trail (previous/new quantities) is accurate

**Cash Counter:**
- [ ] Open counter for today
- [ ] Cannot open counter if already open
- [ ] Cannot open for future date
- [ ] Close counter calculates variance correctly
- [ ] Cannot close unopened counter
- [ ] Verify counter with correct password
- [ ] Verify counter with incorrect password (should fail)
- [ ] Cannot verify unverified counter
- [ ] Cannot verify already verified counter
- [ ] Cash payments calculation is accurate

---

### Integration Tests

**Inventory Workflow:**
- [ ] Admin adds item â†’ Item appears in list
- [ ] Admin records purchase â†’ Quantity increases, transaction logged
- [ ] Staff records usage â†’ Quantity decreases, transaction logged
- [ ] Physical count adjustment â†’ Quantity corrected, transaction logged
- [ ] Low stock alert appears when below threshold
- [ ] Low stock alert disappears when stock replenished

**Cash Counter Workflow:**
- [ ] Admin opens counter â†’ Status: Open
- [ ] Orders are paid with cash during day â†’ Total tracked
- [ ] Admin closes counter â†’ Expected calculated correctly
- [ ] Owner verifies counter â†’ Status: Verified
- [ ] Next day counter can be opened

---

### API Endpoint Tests

**For Each Endpoint:**
- [ ] Valid request returns 200/201
- [ ] Invalid request returns 400 with error message
- [ ] Unauthorized request returns 401 (auth-required endpoints)
- [ ] Not found returns 404 (when applicable)
- [ ] Response schema matches specification
- [ ] Query parameters work correctly
- [ ] Pagination works (where applicable)

---

### UI/UX Tests

**Dark Mode:**
- [ ] Theme toggle button appears in sidebar/header
- [ ] Clicking toggle switches theme immediately
- [ ] All pages render correctly in dark mode
- [ ] Colors have sufficient contrast (WCAG AA)
- [ ] Transitions are smooth (200ms)
- [ ] Theme persists after page refresh
- [ ] System preference detected correctly
- [ ] No flash of wrong theme on page load

**Desktop (Admin):**
- [ ] Inventory items page loads and displays items
- [ ] Add item modal works, saves data
- [ ] Edit item modal pre-fills, updates data
- [ ] Delete item shows confirmation
- [ ] Record purchase modal works with multiple items
- [ ] Physical adjustment modal calculates difference
- [ ] Low stock alert card shows correct items
- [ ] Transaction history filters work
- [ ] Cash counter card shows correct status
- [ ] Open/close/verify modals work correctly
- [ ] Sidebar navigation to inventory sections works

**Mobile (Kitchen Staff):**
- [ ] Usage recording page loads on mobile
- [ ] Touch targets are large enough (48px min)
- [ ] Number pad appears for quantity inputs
- [ ] Search functionality works
- [ ] Category accordions expand/collapse
- [ ] Submit works with multiple items
- [ ] Confirmation dialog appears
- [ ] Success toast shows after submit
- [ ] Works offline (submits when back online)

---

### Performance Tests

- [ ] Get inventory items with 100+ items (< 500ms)
- [ ] Record bulk purchase (10 items) (< 1s)
- [ ] Record bulk usage (20 items) (< 1s)
- [ ] Transaction history with 1000+ records (< 1s)
- [ ] Cash counter calculations (< 100ms)
- [ ] Low stock query with 50+ items (< 200ms)

---

### Edge Cases

**Inventory:**
- [ ] Item with 0 quantity can still be used (goes negative with warning)
- [ ] Adjustment to exact quantity 0
- [ ] Purchase/usage with very large quantities (10000+)
- [ ] Concurrent purchases/usages on same item
- [ ] Search with special characters
- [ ] Category with 50+ items

**Cash Counter:**
- [ ] Opening balance = 0
- [ ] No cash payments during day (expected = opening)
- [ ] Large variance (>â‚¹1000)
- [ ] Multiple verify attempts with wrong password
- [ ] Verify immediately after close
- [ ] Previous day counter never verified

---

## âœ… Definition of Done

Version 0.2 is **complete and ready for deployment** when:

### Dark Mode
1. âœ… Theme toggle button accessible on all pages
2. âœ… Theme switches smoothly between light and dark
3. âœ… Theme preference persists across sessions
4. âœ… System preference detected on first visit
5. âœ… All existing v0.1 pages support dark mode
6. âœ… All new v0.2 pages support dark mode
7. âœ… Color contrast meets WCAG AA standards
8. âœ… No flash of unstyled content on page load

### Inventory Management
1. âœ… Admin can create, edit, delete inventory categories
2. âœ… Admin can create, edit, soft-delete inventory items
3. âœ… Admin can record purchases (bulk)
4. âœ… Kitchen staff can record daily usage on mobile
5. âœ… Admin can make physical count adjustments
6. âœ… Low stock alerts display on admin dashboard
7. âœ… Transaction history shows complete audit trail
8. âœ… All inventory features work reliably

### Cash Counter
9. âœ… Admin can open daily cash counter
10. âœ… Admin can close counter with variance calculation
11. âœ… Owner can verify counter with password prompt
12. âœ… Cash counter history is viewable
13. âœ… Variance calculations are accurate
14. âœ… Cannot verify without correct owner password

### Quality
15. âœ… All unit tests passing
16. âœ… All integration tests passing
17. âœ… Mobile usage form tested on actual phones
18. âœ… Desktop admin tested on cafe laptop
19. âœ… Works reliably on cafe's WiFi network
20. âœ… Database migrations run successfully
21. âœ… No critical bugs identified
22. âœ… Documentation updated

### Deployment
23. âœ… Production build succeeds
24. âœ… Deployed to cafe laptop
25. âœ… Staff trained on new features
26. âœ… Client feedback collected
27. âœ… Owner comfortable with verification workflow
28. âœ… Kitchen staff comfortable with usage recording

---

## ğŸ“¦ Deployment Notes

### Environment Variables (.env additions)

```bash
# Existing v0.1 variables
SECRET_KEY=...
ADMIN_USERNAME=admin
ADMIN_PASSWORD=...

# New for v0.2
OWNER_PASSWORD=different_secure_password
# Bcrypt hash: bcrypt.hashpw(OWNER_PASSWORD.encode(), bcrypt.gensalt())
```

### Database Migration

```bash
# Backup current database
cp restaurant.db restaurant_v0.1_backup.db

# Run migration
uv run python backend/scripts/migrate_v0.2.py

# Verify migration
uv run python backend/scripts/verify_tables.py
```

### Seed Data (Development)

```python
# backend/scripts/seed_inventory.py
def seed_inventory_data(db):
    # Categories
    dairy = InventoryCategory(name="Dairy")
    grains = InventoryCategory(name="Grains")
    vegetables = InventoryCategory(name="Vegetables")
    
    # Items
    milk = InventoryItem(
        name="Milk",
        unit="L",
        current_quantity=20,
        min_threshold=10,
        cost_per_unit=60,
        category=dairy
    )
    
    flour = InventoryItem(
        name="Flour",
        unit="kg",
        current_quantity=15,
        min_threshold=5,
        cost_per_unit=45,
        category=grains
    )
    
    # ... more items
    
    db.add_all([dairy, grains, vegetables, milk, flour])
    db.commit()
```

---

## ğŸ“ Learning Opportunities

### React/Frontend Concepts in v0.2

1. **React Context API for Global State**
   - Why: Share theme across all components without prop drilling
   - Analogy: Like Redux but simpler, built into React
   - New Concept: Context Provider pattern

2. **localStorage for Client-Side Persistence**
   - Why: Remember user preferences across sessions
   - Analogy: Like cookies but simpler, client-only
   - New Concept: Browser storage APIs

3. **CSS Variables for Dynamic Theming**
   - Why: Change colors app-wide without class changes
   - Analogy: Like SCSS variables but dynamic at runtime
   - New Concept: CSS custom properties

4. **Tailwind Dark Mode with Class Strategy**
   - Why: Conditional styling based on parent class
   - Analogy: Like media queries but for theme
   - New Concept: Utility-first dark mode

5. **System Preference Detection**
   - Why: Respect user's OS-level dark mode setting
   - Analogy: Like responsive design for color scheme
   - New Concept: prefers-color-scheme media query

### Python/FastAPI Concepts in v0.2

1. **Decimal Type for Financial Data**
   - Why: Avoid float precision errors
   - Analogy: Like using BigInt in JavaScript for currency

2. **Database Transactions for Atomic Operations**
   - Why: Ensure data consistency
   - Analogy: Like React's setState batching

3. **Enums for Type Safety**
   - Why: Limit values to valid set
   - Analogy: Like TypeScript's union types

4. **Computed Properties in SQLAlchemy**
   - Why: Derive values without storing duplicates
   - Analogy: Like React's useMemo

5. **Password Verification (bcrypt)**
   - Why: Secure password checking
   - New Concept: One-way hashing

---

## ğŸ“ Support Information

**Developer:** Angel  
**Client:** Lily Cafe by Mary's Kitchen  
**Version:** 0.2  
**Prerequisites:** v0.1 deployed and working  

**For Issues:**
1. Check logs: `backend/logs/`
2. Verify database: Check new tables exist
3. Test endpoints: Use Swagger UI at `/docs`
4. Mobile testing: Use actual phone on WiFi
5. Cash counter: Verify owner password hash in .env

---

## ğŸ“š References

**Project Documents:**
- Master Project Document: `lily-cafe-pos-master-project-document.md`
- v0.1 Technical Spec: `v0.1-technical-spec.md`
- v0.1 Completion Report: `v0.1-completion-report.md`
- UV Quick Reference: `UV-QUICK-REFERENCE.md`

**External Resources:**
- FastAPI Documentation: https://fastapi.tiangolo.com
- SQLAlchemy 2.0: https://docs.sqlalchemy.org
- Pydantic: https://docs.pydantic.dev
- React Query: https://tanstack.com/query
- Decimal in Python: https://docs.python.org/3/library/decimal.html

---

**Document Version:** 1.0  
**Created:** November 11, 2025  
**Status:** Final - Ready for Development  
**Approved By:** Angel (Developer) & Claude (Planning Assistant)

---

ğŸ‰ **You're all set to start building Version 0.2!**

Let me know when you're ready to begin implementation, and we can start with database models and migrations!
